/*! backbone-ardent - v0.5.0 - 2013-07-08
* Copyright (c) 2013 Jason Allred; Licensed MIT */
Backbone.Ardent=function(a,b){"use strict";function c(){for(var a,b,d,e,f,g=arguments[0]||{},h=1,i=arguments.length;i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],b=e[d],g!==b&&(b&&"object"==typeof b?(f=a&&"object"==typeof a?a:{},g[d]=c(f,b)):void 0!==b&&(g[d]=b));return g}var d={};!function(a){!function(){function b(){for(var a,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length;i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(c&&"object"==typeof c?(f=a&&"object"==typeof a?a:{},g[d]=b(f,c)):void 0!==c&&(g[d]=c));return g}function c(a,c){return b({},a,c)}var d={accepted:"The :attribute must be accepted.",alpha:"The :attribute field must contain only alphabetic characters.",alpha_dash:"The :attribute field may only contain alpha-numeric characters, as well as dashes and underscores.",alpha_num:"The :attribute field must be alphanumeric.",confirmed:"The :attribute confirmation does not match.",email:"The :attribute format is invalid.",def:"The :attribute attribute has errors.",different:"The :attribute and :different must be different.","in":"The selected :attribute is invalid.",integer:"The :attribute must be an integer.",min:{numeric:"The :attribute must be at least :min.",string:"The :attribute must be at least :min characters."},max:{numeric:"The :attribute must be less than :max.",string:"The :attribute must be less than :max characters."},not_in:"The selected :attribute is invalid.",numeric:"The :attribute must be a number.",required:"The :attribute field is required.",same:"The :attribute and :same fields must match.",size:{numeric:"The :attribute must be :size.",string:"The :attribute must be :size characters."},url:"The :attribute format is invalid."},e=function(){};e.prototype={constructor:e,get:function(a){return this[a]?this[a]:[]},first:function(a){return this[a]?this[a][0]:!1}};var f=function(a,b,f){this.input=a,this.rules=b,this.messages=c(d,f||{}),this.errors=new e,this.errorCount=0,this.check()};f.prototype={constructor:f,_createMessage:function(a,b){var c,d;if("string"==typeof a&&"object"==typeof b){c=a;for(d in b)b.hasOwnProperty(d)&&(c=c.replace(":"+d,b[d]))}return c},check:function(){var a,b,c,d,e,f,g,h,i,j,k;for(a in this.input)if(this.input.hasOwnProperty(a)&&(b=this.input[a],this.rules.hasOwnProperty(a)))for(c=this.rules[a].split("|"),d=c.length,e=0;d>e;e++)f=c[e],f.indexOf(":")>=0?(f=f.split(":"),g=f[1],f=f[0]):g=null,h=this.validate[f].call(this,b,g,a),h||(this.errors.hasOwnProperty(a)||(this.errors[a]=[]),k=this._createErrorMessageTemplateData(a,f,g),j=this._selectMessageTemplate(f,b,a),i=this._createMessage(j,k),this._addErrorMessage(a,i))},_addErrorMessage:function(a,b){this.errors[a].push(b),this.errorCount++},_createErrorMessageTemplateData:function(a,b,c){var d={attribute:a};return d[b]=c,d},_selectMessageTemplate:function(a,b,c){var d,e=this.messages;if(e.hasOwnProperty(a+"."+c))d=e[a+"."+c];else if(e.hasOwnProperty(a)){if(d=e[a],"object"==typeof d)switch(typeof b){case"number":d=d.numeric;break;case"string":d=d.string}}else d=e.def;return d},passes:function(){return 0===this.errorCount?!0:!1},fails:function(){return this.errorCount>0?!0:!1},first:function(a){return this.errors.hasOwnProperty(a)?this.errors[a][0]:null},validate:{required:function(a){var b;return void 0===a||null===a?!1:(b=String(a).replace(/\s/g,""),b.length>0?!0:!1)},size:function(a,b){return b=parseFloat(b),"number"==typeof a?a===b?!0:!1:a.length===b?!0:!1},min:function(a,b){return"number"==typeof a?a>=b?!0:!1:a.length>=b?!0:!1},max:function(a,b){return"number"==typeof a?b>=a?!0:!1:a.length<=b?!0:!1},email:function(a){return/\w+@\w{2,}\.\w{2,}/.test(a)},numeric:function(a){var b=Number(a);return"number"!=typeof b||isNaN(b)||"boolean"==typeof a?!1:!0},url:function(a){return/^https?:\/\/\S+/.test(a)},alpha:function(a){return/^[a-zA-Z]+$/.test(a)},alpha_dash:function(a){return/^[a-zA-Z0-9_\-]+$/.test(a)},alpha_num:function(a){return/^[a-zA-Z0-9]+$/.test(a)},same:function(a,b){var c=this.input[b],d=a;return c===d?!0:!1},different:function(a,b){var c=this.input[b],d=a;return c!==d?!0:!1},"in":function(a,b){var c=b.split(","),d=c.length,e=!1;a=String(a);for(var f=0;d>f;f++)if(a===c[f]){e=!0;break}return e},not_in:function(a,b){var c=b.split(","),d=c.length,e=!0;a=String(a);for(var f=0;d>f;f++)if(a===c[f]){e=!1;break}return e},accepted:function(a){return"on"===a||"yes"===a||1===a||"1"===a?!0:!1},confirmed:function(a,b,c){console.log("confirmed",a,b,c);var d=c+"_confirmation";return this.input[d]===a?!0:!1},integer:function(a){return/^\d+$/.test(a)}}},f.register=function(a,b,c){this.prototype.validate[a]=b,"string"==typeof c&&(d[a]=c)},"undefined"!=typeof module&&"undefined"!=typeof require?module.exports=f:a.Validator=f}()}(d);var e=b.Validator=window.Validator||d.Validator;return b.Model.extend({rules:{},messages:{},constructor:function(c,d){d||(d={}),a.extend(this,a.pick(d,"rules","messages")),b.Model.apply(this,arguments)},getRules:function(){return a.isFunction(this.rules)?this.rules.apply(this):this.rules},getMessages:function(){return a.isFunction(this.messages)?this.messages.apply(this):this.messages},validate:function(b,d){var f=b?b:this.attributes,g=this.getRules(),h=this.getMessages();d||(d={}),a.isUndefined(d.rules)||!a.isObject(d.rules)&&!a.isFunction(d.rules)||(g=c({},g,a.isObject(d.rules)?d.rules:d.rules.apply(this))),a.isUndefined(d.messages)||!a.isObject(d.messages)&&!a.isFunction(d.messages)||(h=c({},h,a.isObject(d.messages)?d.messages:d.messages.apply(this)));var i=new e(f,g,h);return this.errors=i.errors,i.fails()?this.errors:void 0},_validateAttrs:function(b,c){if(!c.validate||!this.validate)return!0;var d=this.validationError=this.validate(b,c)||null;return d?(this.trigger("invalid",this,d,a.extend(c||{},{validationError:d})),!1):!0},isValid:function(b,c){var d=a.extend({},this.attributes),e=null;return 1===arguments.length?a.isString(b)||a.isArray(b)?d=a.pick(d,b):a.isObject(b)&&(e=b):arguments.length>1&&((a.isString(b)||a.isArray(b))&&(d=a.pick(d,b)),a.isObject(c)&&(e=c)),this._validateAttrs(d,a.extend(e||{},{validate:!0}))}})}(_,Backbone);